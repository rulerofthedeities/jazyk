<section kmPressed 
  (onKeyPressed)="onKeyPressed($event)">
  <div class="col-xs-8">
    <div class="panel centerpanel">
      <km-bullets *ngIf="!isPractiseDone"
        [data]="exerciseData"
        [current]="current">
      </km-bullets>
      <div *ngIf="!isPractiseDone && isQuestionReady" class="card">
        <km-question
          [currentData]="currentData"
          [lanPair]="lanPair"
          [text]="text"
          [tpe]="getQuestionType()"
          [settings]="settings"
        ></km-question>
        <div class="choices">
          <div 
            *ngFor="let choice of currentChoices; let i=index" 
            class="btn btn-default btn-lg choice"
            [ngClass]="{
              'done':isSelected, 
              'ok':isWordCorrect(-1) && i===answered, 
              'nok':!isWordCorrect(-1) && i===answered,
              'correction':!isWordCorrect(-1) && i===answer}"
            (click)="onSelected(i)">
            <span class="nr">{{i+1}}.</span> <span>{{choice}}</span>
          </div>
        </div>
      </div>

      <!-- PRACTISE DONE -->
      <div *ngIf="isPractiseDone">
        <h3>Words practised:</h3>
        <km-completed-list [data]="exerciseData">
        </km-completed-list>

        <div class="btn btn-success" (click)="onNextWord()">
          <span class="fa fa-step-forward"></span>
          {{text["RestartStudy"]}}
        </div>
      </div>
    </div>
  </div>
  <div class="col-xs-4">
    <km-learn-settings
      [step]="'practise'"
      [hasGenus]="!!this.currentData?.exercise.genus"
      [settings]="settings"
      (updatedSettings)="onSettingsUpdated($event)">
    </km-learn-settings>
    <div class="actions">
      <div 
        class="btn btn-lg next" 
        [ngClass]="{'btn-default': !isSelected, 'btn-success': isSelected}"
        (click)="onNextWord()">
        <span class="fa fa-step-forward"></span>
        {{isPractiseDone ? text["Restart"] : text["Next"]}}
      </div>
    </div>
    SCORE : {{score}}
  </div>
  <div class="clearfix"></div>
</section>

<ng-template #loading>
  <span class="loading">
    <span *ngFor="let dot of dotArr">
      <span class="fa fa-circle">
      </span>
    </span>
  </span>
</ng-template>
