<div class="panel panel-default">
  <div class="panel-heading">
    <span class="fa fa-bell-o"></span>
      {{currentNotification ? currentNotification.title : text["Notifications"]}}
    <span 
      *ngIf="currentNotification"
      (click)='onCloseNotification()'
      class="fa fa-times pull-right">
    </span>
    <button 
      *ngIf="!currentNotification"
      type="button"
      (click)='onDeleteAllRead()'
      class="btn btn-danger pull-right btn-deleteall">
      <span class="fa fa-trash"></span> {{text['DeleteAllReadNotifications']}}
    </button>
    <button 
      *ngIf="!currentNotification"
      type="button"
      (click)='onMarkAllRead()'
      class="btn btn-warning pull-right">
      <span class="fa fa-check"></span> {{text['MarkAllRead']}}
    </button>
  </div>
  <div class="panel-body">
    <div *ngIf="notifications?.length===0 else notificationsList">
      {{text["NoRecentNotifications"]}}
    </div>
  </div>
  <div class="info-msg">
    <km-info-msg [msg]="infoMsg">
    </km-info-msg>
  </div>
</div>

<ng-template #notificationsList>
  <div class="list-group" *ngIf="!currentNotification else notificiationDetail">
    <a 
      *ngFor="let notification of notifications; let i=index"
      class="list-group-item"
      (click)="onSelectNotification(i)">
      <span class="read fa" [ngClass]="{
        'fa-circle':!notification.read,
        'fa-circle-o': notification.read}">
      </span>
      <span [class.unread]="!notification.read">{{notification.title}}</span>
      <button type="button" *ngIf="notification.read"
        class="btn btn-danger btn-xs btn-delete pull-right"
        (click)="onDeleteNotification(notification._id)">
        <span class="fa fa-trash"></span>
      </button>
      <span class="badge" [class.badgeMargin]="!notification.read">
        {{notification.dt | date: 'dd'}} {{text[notification.dt | date: 'MMMM']}} {{notification.dt | date: 'yyyy'}}
      </span>
    </a>
  </div>
</ng-template>

<ng-template #notificiationDetail>
  <div [innerHTML]="currentNotification.message"
  kmPressed 
  (onKeyPressed)="onKeyPressed($event)">
  </div>
  <div class="badge pull-right">
    {{currentNotification.dt | date: "yyyy-MM-dd HH:mm"}}
  </div>
</ng-template>
