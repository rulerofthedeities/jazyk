<div class="panel panel-default transparant" *ngIf="text">
  <div class="panel-heading">
    <span class="fa fa-user-o fa-spacing-title"></span>{{profile?.userName}}
    <!-- Edit button (go to profile) -->
    <div class="pull-right"  *ngIf="isCurrentUser">
      <button
        type="button"
        class="btn btn-warning"
        (click)="onEditProfile()">
        <span class="fa fa-pencil"></span> {{text["Edit"]}}
      </button>
    </div>
    <!-- Follow / Unfollow button -->
    <div class="pull-right" *ngIf="!isCurrentUser && profile">
      <button
        *ngIf="!isCurrentlyFollowing"
        type="button"
        class="btn btn-success"
        (click)="onFollowUser(profile._id)">
        <span class="fa fa-user-plus"></span> {{text["Follow"]}} '{{profile?.userName}}'
      </button>
      <div *ngIf="isCurrentlyFollowing">
        <div class="following">
          <span class="fa fa-check"></span> {{text['Following']}}
          <button
            type="button"
            (click)="onUnfollowUser(profile._id)"
            class="btn btn-warning btn-sm">
            <span class="fa fa-times"></span> {{text["Unfollow"]}}
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="panel-body">
    <div class="row">
      <div class="col-xs-2">
        <div class="gravatar col-xs-2">
          <img kmGravatar [hash]="profile.emailHash" [width]="96" *ngIf="profile">
        </div>
      </div>
      <div class="col-xs-10 data">
        <div class="row " *ngIf="profile?.profile?.realName">
          <label
            for="bio"
            class="control-label col-xs-3">
            {{text['RealName']}}
          </label>
          <div class="col-xs-9">
            {{profile.profile.realName}}
          </div>
        </div>
        <div class="row" *ngIf="profile?.profile?.location">
          <label
            for="location"
            class="control-label col-xs-3">
            {{text['Location']}}
          </label>
          <div class="col-xs-9">
            {{profile.profile.location}}
          </div>
        </div>
        <div class="row" *ngIf="profile?.profile?.nativeLan">
          <label
            for="language"
            class="control-label col-xs-3">
            {{text['NativeLanguage']}}
          </label>
          <div class="col-xs-9">
            {{profile.profile.nativeLan}}
          </div>
        </div>
        <div class="row" *ngIf="profile?.profile?.bio">
          <label
            for="bio"
            class="control-label col-xs-3">
            {{text['Bio']}}
          </label>
          <div class="col-xs-9">
            {{profile.profile.bio}}
          </div>
        </div>
        <div class="row">
          <label
            for="joinDate"
            class="control-label col-xs-3">
            {{text['JoinDate']}}
          </label>
          <div class="col-xs-9">
            {{profile?.dtJoined | date: 'dd'}} {{text[profile?.dtJoined | date: 'MMMM']}} {{profile?.dtJoined | date: 'yyyy'}}
          </div>
        </div>
        <div class="row">
          <label
            for="rank"
            class="control-label col-xs-3">
            {{text['Rank']}}
          </label>
          <div class="col-xs-9">
              <img src="/assets/img/ranks/rank{{rank}}_32b.png" class="img">
            {{text['rank' + rank + gender]}}
          </div>
        </div>
        <div class="row">
          <label
            for="points"
            class="control-label col-xs-3">
            {{text['Points']}}
          </label>
          <div class="col-xs-9">
            {{score | score}}
          </div>
        </div>
        <div class="row">
          <label
            for="trophies"
            class="control-label col-xs-3">
            {{text['Trophies']}}
          </label>
          <div class="col-xs-9">
            <span *ngFor="let trophy of trophies">
              <img src="/assets/img/trophies/trophy{{trophy.trophy}}.png"
                class="trophy"
                [tooltip]="text['trophy' + trophy.trophy] || ''"
                placement="top">
            </span>
          </div>
        </div>
        <div class="row">
          <label
            for="network"
            class="control-label col-xs-3">
            {{text['Network']}}
          </label>
          <div class="col-xs-9">
            {{text['Following2']}} {{network?.following?.length || text['noone']}} {{ network?.following?.length === 1 ? text['person'] : (network?.following?.length === 0 ? '' : text['people'])}}
          </div>
          <div class="col-xs-9 col-xs-offset-3">
            {{text['FollowedBy']}} {{network?.followers?.length || text['noone']}}
            <span *ngIf="network?.followers?.length">
              {{network?.followers?.length === 1 ? text['person'] : text['people']}}
            </span>
          </div>
          <div class="col-xs-9 col-xs-offset-3" *ngIf="network?.buddies?.length > 0">
              {{network?.buddies?.length}} {{network?.buddies?.length === 1 ? text['buddy']: text['buddies']}}
          </div>
        </div>
        <div class="row" *ngIf="!isCurrentUser && (isAdmin || (isCurrentlyFollowing && isCurrentlyFollowed && profile))">
          <button [style.display]="messageShown ? 'none' : 'inline-block'"
            type="button"
            (click)="onCreateMessage(msgField)"
            class="btn btn-primary btn-sm">
            <span class="fa fa-envelope"></span> {{text["SendMessage"]}}
          </button>
          <div [style.display]="messageShown ? 'block' : 'none'">
            <km-message
              [sendTxt]="text['Send']"
              (send)="onSendMessage($event)"
              #msgField>
            </km-message>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div  class="info-msg">
    <km-info-msg [msg]="infoMsg">
    </km-info-msg>
  </div>
</div>
