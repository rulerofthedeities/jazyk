<div class="panel panel-default">
  <div class="panel-body">
    <div class="row buttons">
      <div class="col-xs-12">
        <ng-container *ngTemplateOutlet="saveButtonTemplate;context:{modified:modified, saved:saved}">
        </ng-container>
        <span #dropdown>
          <div class="btn-group">
            <div 
              class="btn btn-primary dropdown-toggle"
              (click)="onToggleButton('arrange')">
              {{text["Arrange"]}} <span class="caret"></span>
            </div>
            <ul class="dropdown-menu" [style.display]="dropdowns['arrange'] ? 'block': 'none'">
                <li (click)="onInsertTemplate('table', 'arrange')">
                  <a>{{text["Table"]}}</a>
                </li>
                <li (click)="onInsertTemplate('list', 'arrange')">
                  <a>{{text["List"]}}</a>
                </li>
            </ul>
          </div>
          <div class="btn-group">
            <div 
              class="btn btn-primary dropdown-toggle"
              (click)="onToggleButton('header')">
              {{text["Headers"]}} <span class="caret"></span>
            </div>
            <ul class="dropdown-menu" [style.display]="dropdowns['header'] ? 'block': 'none'">
                <li (click)="onInsertTemplate('header', 'header')">
                  <a>{{text["MainHeader"]}}</a>
                </li>
                <li (click)="onInsertTemplate('subheader', 'header')">
                  <a>{{text["SubHeader"]}}</a>
                </li>
                <li (click)="onInsertTemplate('subsubheader', 'header')">
                  <a>{{text["SubSubHeader"]}}</a>
                </li>
            </ul>
          </div>
          <div class="btn-group">
            <div 
              class="btn btn-primary dropdown-toggle"
              (click)="onToggleButton('size')">
              {{text["Size"]}} <span class="caret"></span>
            </div>
            <ul class="dropdown-menu" [style.display]="dropdowns['size'] ? 'block': 'none'">
                <li (click)="onInsertTemplate('size1', 'size')">
                  <a>{{text["Large"]}}</a>
                </li>
                <li (click)="onInsertTemplate('size2', 'size')">
                  <a>{{text["Larger"]}}</a>
                </li>
                <li (click)="onInsertTemplate('size3', 'size')">
                  <a>{{text["Largest"]}}</a>
                </li>
            </ul>
          </div>
          <div class="btn-group">
            <div 
              class="btn btn-primary dropdown-toggle"
              (click)="onToggleButton('other')">
              {{text["Miscellaneous"]}} <span class="caret"></span>
            </div>
            <ul class="dropdown-menu" [style.display]="dropdowns['other'] ? 'block': 'none'">
                <li (click)="onInsertTemplate('italic', 'other')">
                  <a>{{text["Italic"]}}</a>
                </li>
                <li (click)="onInsertTemplate('bold', 'other')">
                  <a>{{text["Bold"]}}</a>
                </li>
                <li (click)="onInsertTemplate('border', 'other')">
                  <a>{{text["Border"]}}</a>
                </li>
                <li (click)="onInsertTemplate('color', 'other')">
                  <a>{{text["Color"]}}</a>
                </li>
                <li (click)="onInsertTemplate('tabfirstline', 'other')">
                  <a>{{text["TabFirstLine"]}}</a>
                </li>
                <li (click)="onInsertTemplate('tabblock', 'other')">
                  <a>{{text["TabBlock"]}}</a>
                </li>
                <li (click)="onInsertTemplate('list', 'other')">
                  <a>{{text["List"]}}</a>
                </li>
                <li (click)="onInsertTemplate('audio', 'other')">
                  <a>{{text["Audio"]}}</a>
                </li>
            </ul>
          </div>
        </span>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-6">
        <textarea
          class="form-control"
          autocomplete="off"
          autocorrect="off"
          autocapitalize="off"
          spellcheck="false" 
          [(ngModel)]="intro.text"
          (ngModelChange)="onChangedIntro()"
          rows="50"
          #introField="ngModel"
          #insertField>
        </textarea>
        <ng-container *ngTemplateOutlet="saveButtonTemplate;context:{modified:modified, saved:saved}">
        </ng-container>
      </div>
      <div class="col-xs-6 markdown">
        <km-intro [html]="intro?.html">
        </km-intro>
      </div>
    </div>
  </div>
</div>

<ng-template #saveButtonTemplate let-modified=modified let-saved=saved>
  <button type="button" class="btn"
    (click)="onSaveIntro()"
    [ngClass]="{
      'btn-success':modified,
      'btn-default':!modified
    }"
    [disabled]="!modified">
    <span class="fa fa-check" [class.fa-check]="saved"></span>
    {{text[saved ? "Updated" : "Update"]}}
  </button>
</ng-template>