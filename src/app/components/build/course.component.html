<form
  [formGroup]="courseForm"
  (ngSubmit) = "onSubmit(courseForm.value)"
  *ngIf="isFormReady"
  class="form-horizontal">

  <!-- LANGUAGE -->
  <div class="form-group form-group-lg">
    <label for="language" class="control-label col-xs-2">Taal</label>
    <div class="col-xs-10">
      <km-language-selector 
        [languages]="languages"
        [currentLanguage]="currentLanguage"
        [disabled]="!isNewCourse"
        (languageSelected)="onLanguageSelected($event)">
      </km-language-selector>
    </div>
  </div>

  <!-- NAME -->
  <div class="form-group form-group-lg">
    <label for="name" class="control-label col-xs-2">Naam</label>
    <div class="col-xs-10">
      <input 
        *ngIf="isEditMode"
        type="text" 
        class="form-control" 
        autocomplete="off"
        id="name" 
        placeholder="Naam van de cursus"
        [formControlName]="'name'">
      <div *ngIf="!isEditMode" class="form-control-static">
        {{course.name}}
      </div>
    </div>
  </div>

  <!-- PUBLIC & PUBLISH -->
  <div class="form-group form-group-lg">
    <label for="status" class="control-label col-xs-2">Status</label>
    <div class="col-xs-10">
      <button 
        class="btn"
        id="status" 
        (click)="onTogglePublic()"
        [ngClass]="{'disabled':isSavingPublic,'btn-success':course.isPublic,'btn-muted':!course.isPublic}">
        <span class="fa fa-user"></span>
        {{course.isPublic ? 'Publiek' : 'Privaat'}}
      </button>
      <button 
        class="btn"
        (click)="onTogglePublished()"
        [ngClass]="{disabled:isSavingPublished,'btn-success':course.isPublished,'btn-muted':!course.isPublished}">
        <span class="fa fa-power-off"></span>
        {{course.isPublished ? 'Gepubliceerd' : 'Niet Publiceerd' }}
      </button>
    </div>
  </div>
  <p>Form value: {{ courseForm.value | json }}</p>
  <p>Form status: {{ courseForm.status | json }}</p>
  <p>Form dirty: {{courseForm.dirty |json}}</p>

  <!-- BUTTONS -->
  <div class="row">
    <div class="col-xs-10 col-xs-offset-2">

    <!-- EDIT MODE -->
      <div *ngIf="isEditMode">
        <button
          type="submit" 
          class="btn btn-success" 
          [disabled]="!courseForm.valid || !courseForm.dirty">
          {{isNewCourse ? 'Voeg cursus toe' : 'Voer wijzigingen door'}}
        </button>
        <button 
          class="btn btn-warning" 
          (click)="onCancel()">
          Cancel
        </button>
      </div>

    <!-- READ MODE -->
      <div *ngIf="!isEditMode && !isEditLesson">
        <button
          class="btn btn-success" 
          (click)="onSetEdit()">
          Wijzig cursusgegevens
        </button>
        <button
          class="btn btn-success" 
          (click)="onAddLesson()">
          Voeg nieuwe les toe
        </button>
      </div>
    </div>
  </div>  
</form>

<!-- NEW LESSON -->
<div *ngIf="isEditLesson">
  <km-build-lesson-header
    [lesson]="currentLesson"
    [lessons]="lessons"
    [chapters]="chapters"
    [courseId]="course._id"
    [languageId]="course.languageId"
    [nr]="lessons.length"
    (done)="onLessonDone($event)">
  </km-build-lesson-header>
</div>

<!-- CHAPTER / LESSON LIST -->

<div *ngIf="lessons">
  <km-build-lessons
    [lessons]="lessons"
    [chapters]="chapters"
    [courseId]="course._id">
  </km-build-lessons>
</div>

