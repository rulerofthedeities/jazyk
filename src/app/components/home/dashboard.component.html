<div class="row">
  <!-- Summary -->
  <div class="col-md-6 col-xs-12">
    <div class="panel panel-default status transparant">
      <div class="panel-heading">
        <span class="fa fa-file-o fa-spacing-title"></span>
        {{text["Summary"]}}
      </div>
      <div class="panel-body panel-summary">
        <div *ngIf="summaryData && !isLoadingOverview">
          <div class="col-xs-6 score-col">
            <div class="rank info" (click)="onShowRankings(ranks)">
              <img src="/assets/img/ranks/rank{{rank}}_64.png" class="img">
              <span class="rank-name">{{rankName}}</span>
            </div>
            <div class="score info">
              <a routerLink="/user/score" class="points">{{summaryData.score | score}} {{text["points"]}}</a>
            </div>
            <div class="next-rank" *ngIf="hasNextRank">
              {{toGoNextRank | score}} {{text["pointsToNextRank"]}}
            </div>
          </div>
          <div class="col-xs-6 learned-col">
            <div class="learning info">
              <strong>{{summaryData.read?.finished || 0}}</strong> {{summaryData.read?.finished === 1 ? text["bookCompleted"] : text["booksCompleted"]}}<br>
              <strong>{{summaryData.listen?.finished || 0}}</strong> {{summaryData.listen?.finished === 1 ? text["bookListened"] : text["booksListened"]}}<br>
              <strong>{{summaryData.wordsMemorized || 0}}</strong> {{summaryData.wordsMemorized === 1 ? text["wordMemorized"] : text["wordsMemorized"]}}
            </div>
          </div>
        </div>
        <km-loader *ngIf="isLoadingOverview && !isError"
          [msg]="text['Loading']"
          [showBackground]="false">
        </km-loader>
      </div>
    </div>
  </div>
  <!-- Notification -->
  <div class="col-md-6 col-xs-12">
    <div class="panel panel-default notifications transparant">
      <div class="panel-heading">
        <span class="fa fa-envelope-open-o fa-spacing-title"></span>
        {{text["Messages"]}}
      </div>
      <div class="panel-body panel-messages">
        <div class="list-group">
          <a class="list-group-item"
            *ngFor="let message of communications; let i=index"
            (click)="onSelectMessage(i)">
            <span class="badge">
              {{getFromNow(message.dt)}}
            </span>
            <span class="fa fa-spacing"
              [ngClass]="{
                'fa-envelope-o': message.tpe==='message',
                'fa-bell-o': message.tpe==='notification'
              }">
            </span>
            <span class="fa fa-spacing"
              [ngClass]="{
                'fa-circle': !message.read,
                'fa-circle-o': message.read,
                'fa-envelope-o': message.tpe==='message',
                'fa-bell-o': message.tpe==='notification'
              }">
            </span>
            <span class="user truncate">
              {{message.from}}
            </span>
            <span
              class="content truncate"
              [class.unread]="!message.read">
              {{message.message}}
            </span>
            <div class="clearfix"></div>
          </a>
        </div>
        <km-loader *ngIf="isLoadingCommunication && !isError"
          [msg]="text['Loading']"
          [showBackground]="false">
        </km-loader>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <!-- Recent books -->
  <div class="col-xs-12">
    <div class="panel panel-default books transparant">
      <div class="panel-heading">
        <span class="fa fa-book fa-spacing-title"></span>
        {{text["RecentActivity"]}}
      </div>
      <div class="panel-body">
        <div *ngIf="recentReady">
          <ul class="list-unstyled" *ngIf="recent?.length">
            <li *ngFor="let item of recent">
              <km-recent-story
                [text]="text"
                [licenses]="licenses"
                [item]="item">
              </km-recent-story>
            </li>
          </ul>
          <div *ngIf="!recent?.length">
            {{text["NoRecentStudied"]}}
          </div>
        </div>
        <km-loader *ngIf="isLoadingRecent && !isError"
          [msg]="text['LoadingCourses']"
          [showBackground]="false">
        </km-loader>
      </div>
    </div>
  </div>
</div>

<km-modal-ranks #ranks
  [rank]="rank"
  [text]="text">
</km-modal-ranks>
