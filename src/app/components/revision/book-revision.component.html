<section>
  <km-book-title *ngIf="book"
    [text]="text"
    [bookType]="bookType"
    [bookLanCode]="book?.lanCode"
    [userLanCode]="userLanCode"
    [bookTitle]="book?.title"
    [chapterTitle]="currentChapterTitle"
  ></km-book-title>
  <div class="panel panel-default" *ngIf="chapterData">
    <div class="panel-body">
      <div class="col-xs-6 source">
        <div *ngIf="chapterData && !hasChapters">
          <ng-container *ngTemplateOutlet="sentencesTemplate;context:{
            chapterSentences: chapterData
          }"></ng-container>
        </div>
      </div>
      <div class="col-xs-6 target">
        TL
      </div>
    </div>
  </div>
</section>

<km-info-msg [msg]="msg" *ngIf="msg">
</km-info-msg>

<ng-template #sentencesTemplate let-chapterSentences=chapterSentences>
  <span  *ngFor="let sentenceData of chapterSentences; let i= index">
    <p *ngIf="sentenceData.sentence.isEmptyLine" class="newline-space">&nbsp;</p>
    <p *ngIf="sentenceData.sentence.isNewParagraph" class="paragraph-space">&nbsp;</p>
    <span
      class="sentence"
      (click)="onSelectSentence(i)"
      [ngClass]="{
        paragraph: sentenceData.sentence.isNewParagraph,
        header: sentenceData.sentence.isHeader,
        header1: sentenceData.sentence.isHeader && level === 1,
        header2: sentenceData.sentence.isHeader && level === 2,
        header3: sentenceData.sentence.isHeader && level === 3,
        header4: sentenceData.sentence.isHeader && level === 4,
        yes: sentenceData.lastAnswer.toLowerCase() === 'y',
        maybe: sentenceData.lastAnswer.toLowerCase() === 'm',
        no: sentenceData.lastAnswer.toLowerCase() === 'n',
        'under-maybe': sentenceData.lastAnswer === 'Y' || sentenceData.lastAnswer === 'N',
        'selected': currentSentence === i
      }">{{sentenceData.sentence.text}}
    </span>
  </span>
</ng-template>
